module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'node',
  setupFiles: ['<rootDir>/tests/env.setup.js'],
  setupFilesAfterEnv: ['<rootDir>/tests/jest.setup.ts'],
  testMatch: ['**/tests/**/?(*.)+(spec|test).ts'],
  moduleFileExtensions: ['ts', 'js', 'json', 'node'],
  roots: [
    '<rootDir>/tests',
    '<rootDir>/app',
    '<rootDir>/repository',
    '<rootDir>/service',
    '<rootDir>/controller',
    '<rootDir>/dto',
    '<rootDir>/exception',
  ],
  moduleNameMapper: {
    '^@/(.*)$': '<rootDir>/$1',
    '^@app/(.*)$': '<rootDir>/app/$1',
    '^@configuration/(.*)$': '<rootDir>/configuration/$1',
    '^@controller/(.*)$': '<rootDir>/controller/$1',
    '^@repository/(.*)$': '<rootDir>/repository/$1',
    '^@utils/(.*)$': '<rootDir>/utils/$1',
    '^@config/(.*)$': '<rootDir>/configuration/$1',
    '^@dto/(.*)$': '<rootDir>/dto/$1',
    '^@service/(.*)$': '<rootDir>/service/$1',
    '^@exception/(.*)$': '<rootDir>/exception/$1',
    '^@middleware/(.*)$': '<rootDir>/middleware/$1',
    '^@common/(.*)$': '<rootDir>/common/$1',
    '^@test/(.*)$': '<rootDir>/test/$1',
    '^@prisma$': '<rootDir>/generated/prisma',
    '^@prisma/(.*)$': '<rootDir>/generated/prisma/$1',
  },
  transform: {
    '^.+\\.ts$': 'ts-jest',
  },
  collectCoverage: true,
  coverageDirectory: 'coverage',
  coverageReporters: ['text', 'lcov', 'html'],
  collectCoverageFrom: [
    'app/**/*.ts',
    'controller/**/*.ts',
    'middleware/**/*.ts',
    'service/**/*.ts',
    'repository/**/*.ts',
    'utils/**/*.ts',
    '!**/node_modules/**',
    '!**/generated/**',
  ],
  coveragePathIgnorePatterns: [
    '/node_modules/',
    '/dto/',
    '/common/',
    '/configuration/',
    '/generated/',
    '/prisma/',
  ],
};
